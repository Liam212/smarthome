awful design and code practice 
re write in nodejs